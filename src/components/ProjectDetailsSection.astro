---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import Container from './Container.astro';

const { project } = Astro.props;
const hasContent = project.content && project.content.length > 0;
---

<section>
  <Container>
    <!-- project-details-wrap: z-1, relative, negative margin-top to overlap breadcrumb -->
    <div class="reveal relative z-[1] mt-[-250px] max-991:mt-[-150px] max-767:mt-[-98px] max-479:mt-[-46px]">

      <!-- project-details-image-wrap: rounded-8 overflow-hidden -->
      <div class="overflow-hidden rounded-8">
        <Image
          src={(project.detailImage || project.image).src}
          alt={(project.detailImage || project.image).alt}
          class="block h-auto w-full transition-transform duration-300 hover:scale-110"
          loading="lazy"
          decoding="async"
          width={1200}
          height={600}
        />
      </div>

      <!-- project-details-content-wrap: border #e5e7eb, rounded-16, mt-30, mx-100, p-30 30 15 -->
      <div class="mt-30 mx-[100px] rounded-[16px] border border-solid border-[#e5e7eb] px-30 pt-30 pb-15 max-991:mx-30 max-767:mx-20 max-767:px-20 max-479:mx-0 max-479:pt-[25px]">
        <!-- project-details-title: mb-0, 40px/50px; responsive -->
        <h2 class="mb-0 text-[40px] leading-[50px] xl:text-[46px] xl:leading-[55px] max-991:text-[36px] max-991:leading-[46px] max-767:text-[28px] max-767:leading-[36px] max-479:text-[26px] max-479:leading-[32px]">
          {project.title}
        </h2>

        <!-- project-details-rich-text-block: mt-15 -->
        <div class="project-details-rich-text mt-15">
          {hasContent ? (
            project.content.map((block) => {
              if (block.type === 'paragraph') {
                return <p class="mb-15">{block.text}</p>;
              }
              if (block.type === 'heading') {
                return <h3>{block.text}</h3>;
              }
              if (block.type === 'list') {
                return (
                  <ol>
                    {block.items.map((item) => <li>{item}</li>)}
                  </ol>
                );
              }
              if (block.type === 'blockquote') {
                return <blockquote>{block.text}</blockquote>;
              }
              if (block.type === 'figure') {
                return (
                  <figure>
                    <Image
                      src={block.image.src as ImageMetadata}
                      alt={block.image.alt}
                      class="h-auto w-full"
                      loading="lazy"
                      decoding="async"
                      width={1000}
                      height={500}
                    />
                  </figure>
                );
              }
              return null;
            })
          ) : (
            <>
              <p class="mb-15">{project.summary}</p>
              {project.details.map((paragraph) => (
                <p class="mb-15">{paragraph}</p>
              ))}
            </>
          )}
        </div>
      </div>
    </div>
  </Container>
</section>

<style>
  /* Rich text children styles */
  .project-details-rich-text :global(h3) {
    letter-spacing: 0.32px;
    margin-top: 30px;
    margin-bottom: 16px;
    font-size: 32px;
    line-height: 41.6px;
  }

  .project-details-rich-text :global(ol) {
    margin-bottom: 27px;
    padding-left: 25px;
    list-style-type: decimal;
  }

  .project-details-rich-text :global(li) {
    background-image: none;
    padding-left: 0;
    font-size: 18px;
    font-weight: 400;
    line-height: 27px;
    list-style-type: decimal;
  }

  .project-details-rich-text :global(figure) {
    border-radius: 16px;
    margin-left: 0;
    margin-right: 0;
    margin-bottom: 15px;
    overflow: hidden;
  }

  .project-details-rich-text :global(blockquote) {
    background-color: #f5f4ea;
    letter-spacing: -0.96px;
    background-image: url('/images/blog-quote.webp');
    background-position: 91% 31px;
    background-repeat: no-repeat;
    background-size: auto;
    border-left: 0 solid #000;
    border-radius: 8px;
    margin-top: 36px;
    margin-right: 0;
    margin-bottom: 36px;
    margin-left: 0;
    padding: 30px 150px 30px 30px;
    font-size: 24px;
    font-weight: 500;
    line-height: 36px;
  }

  @media screen and (min-width: 1280px) {
    .project-details-rich-text :global(blockquote) {
      background-position: 91% 61px;
      padding: 60px 185px 60px 60px;
    }
  }

  @media screen and (max-width: 991px) {
    .project-details-rich-text :global(blockquote) {
      background-position: 95% 31px;
      padding-right: 110px;
      font-size: 20px;
      line-height: 28px;
    }
  }

  @media screen and (max-width: 767px) {
    .project-details-rich-text :global(h3) {
      font-size: 28px;
      line-height: 38px;
    }

    .project-details-rich-text :global(blockquote) {
      background-position: 50% 30px;
      padding-left: 15px;
      padding-right: 80px;
    }
  }

  @media screen and (max-width: 479px) {
    .project-details-rich-text :global(blockquote) {
      text-align: center;
      padding-top: 100px;
      padding-bottom: 24px;
      padding-right: 15px;
    }
  }
</style>
